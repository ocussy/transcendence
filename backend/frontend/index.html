<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Transcendence</title>
    <link href="output.css" rel="stylesheet" />

    <!-- ID client Google -->
    <meta name="google-signin-client_id" content="1560847651-b31pkjflds74sb9s6g1s3enpo71bd5kn.apps.googleusercontent.com" />

    <!-- Nouveau script Google Identity -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  </head>
  <body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen space-y-4">
    <h1 class="text-4xl font-bold mb-4">Bienvenue sur Transcendence üéÆ</h1>
    <p class="text-lg mb-6">Connecte-toi pour commencer √† jouer.</p>

    <!-- Formulaire de login -->
    <div class="flex flex-col space-y-4 bg-gray-800 p-6 rounded-lg shadow-lg w-80">
      <input
        type="login"
        id="login"
        placeholder="Email"
        class="p-2 rounded bg-gray-700 text-white border border-gray-600 focus:outline-none"
      />
      <input
        type="password"
        id="password"
        placeholder="Mot de passe"
        class="p-2 rounded bg-gray-700 text-white border border-gray-600 focus:outline-none"
      />
      <button
        id="loginBtn"
        class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded"
      >
        Se connecter
      </button>
    </div>

    <!-- Bouton Google -->
    <div id="g_id_onload"
     data-client_id="1560847651-b31pkjflds74sb9s6g1s3enpo71bd5kn.apps.googleusercontent.com"
     data-callback="handleCredentialResponse"
     data-auto_prompt="false">
    </div>

    <div class="g_id_signin"
        data-type="standard"
        data-size="large"
        data-theme="outline"
        data-text="sign_in_with"
        data-shape="rectangular"
        data-logo_alignment="left">
    </div>


    <!-- Script connexion classique -->
    <script>
      document.getElementById('loginBtn').addEventListener('click', async () => {
        const login = document.getElementById('login').value;
        const password = document.getElementById('password').value;

        const response = await fetch('auth/signup', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ login, password })
        });

        const data = await response.json();

        if (response.ok) {
          alert('Connexion r√©ussie ‚úÖ');
          console.log(data);
        } else {
          alert('Erreur de connexion ‚ùå');
          console.error(data);
        }
      });
    </script>

    <!-- Script Google Sign-In -->
    <script>
    window.handleCredentialResponse = function(response) {
      const id_token = response.credential;
      console.log('ID token:', id_token);

      fetch('/auth/signup/google', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token: id_token })
      })
      .then(res => res.json())
      .then(data => {
        console.log('Connexion Google r√©ussie ‚úÖ', data);
        // Rediriger ou stocker les infos
      })
      .catch(err => {
        console.error('Erreur Google Sign-In ‚ùå', err);
      });
    }
    </script>

  </body>
</html>
